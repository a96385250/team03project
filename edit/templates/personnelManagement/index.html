{% extends "edit.html" %}
{% load static %}
{% block css %}

{% endblock %}

{% block appcode %}
        <title>修改會員</title>
        <div class="span7">   
                <div class="widget stacked widget-table action-table">
                                    
                    <div class="widget-header">
                        <i class="icon-th-list"></i>
                        <h3>Table</h3>
                    </div> <!-- /widget-header -->
                    
                    <div class="widget-content">
                        
                        <table class="table table-striped table-bordered" id ="tableId">
                            <thead>
                                <tr >
                                    <th id="Engine" >Engine</th>
                                    <th id="Browser">Browser</th>
                                    <th id="Engine">Engine</th>
                                    <th id="Browser">Browser</th>
                                    <th id="Engine">Engine</th>
                                    <th id="membername">membername</th>
                                    <th id="address">address</th>

                                    <th class="td-actions"></th>
                                </tr>
                            </thead>
                            <tbody id="tbodyId">

                            </tbody>
                            
                        </table>
                        
                    </div> <!-- /widget-content -->
                
                </div> <!-- /widget -->
        </div>
            <button id="btnOk" class="btn btn-success" id="addrow"><i class="fas fa-bug"></i></button>
        
    <hr>
    <h1>Web Crawler controls</h1>
    <button id="crawl" class="btn btn-success" id="addrow"><i class="fas fa-bug"></i></button>
    
{% endblock %}
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
{% block script %}
<!-- <script src= "index.js"></script> -->
<script>
        // <讀取資料=================================================================>
$(document).ready(function(){
    function loadTodo(){
        $.getJSON('/api3/Member/',function(datas){
            var tb =  $('#tableId');
            var docFrag = $(document.createDocumentFragment())
            $.each(datas,function(idx,Member){

                var cell1 = $('<td></td>').text(Member.teamid)
                var cell2 = $('<td></td>').text(Member.email).attr('contenteditable','true')
                var cell3 = $('<td></td>').text(Member.password).attr('contenteditable','true')
                var cell4 = $('<td></td>').text(Member.newsletter).attr('contenteditable','true')
                var cell5 = $('<td></td>').text(Member.phoneno).attr('contenteditable','true')
                var cell6 = $('<td></td>').text(Member.username ).attr('contenteditable','true')
                var cell7 = $('<td></td>').text(Member.membername ).attr('contenteditable','true')
                var cell8 = $('<td></td>').text(Member.address ).attr('contenteditable','true')

                var cell9 = $('<td></td>').html('<button class="btn btn-danger"><i class="far fa-trash-alt"></i></button><button class="btn btn-primary"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>').attr('contenteditable','true')
                


                var row = $('<tr></tr>').append([cell1,cell2,cell3,cell4,cell5,cell6,cell7,cell8,cell9])
                //<tbody><tr>
                docFrag.append(row)
            })    //each   
            tb.html(docFrag)
                
            // tb.html(docFrag)
      })//json
   
   
    // <新增資料=================================================================>
    $(document).on("click","#btnOk",function(){
        console.log("abc")
        var tb =  $('#tableId');
        var docFrag = $(document.createDocumentFragment())

        var cell01 = $('<td></td>').text("")
        var cell02 = $('<td></td>').text("").attr('contenteditable','true')
        var cell03 = $('<td></td>').text("").attr('contenteditable','true')
        var cell04 = $('<td></td>').text("").attr('contenteditable','true')
        var cell05 = $('<td></td>').text("").attr('contenteditable','true')
        var cell06 = $('<td></td>').text("").attr('contenteditable','true')
        var cell07 = $('<td></td>').text("").attr('contenteditable','true')
        var cell08 = $('<td></td>').text("").attr('contenteditable','true')

        var cell9 = $('<td></td>').html('<button class="btn btn-danger"><i class="far fa-trash-alt"></i></button><button class="btn btn-primary"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>').attr('contenteditable','true')
                
        var row01 = $('<tr></tr>').append([cell01,cell02,cell03,cell04,cell05,cell06,cell07,cell08,cell9])
        // docFrag.append(row)

        docFrag.append(row01)
        tb.append(docFrag)
    })
    $(document).on(click,"btn btn-danger",function(){

            var th01 = $(this).parent("td:first-child").text
            var th02 = $(this).parent("td:nth-child(2)").text
            var th03 = $(this).parent("td:nth-child(3)").text
            var th04 = $(this).parent("td:nth-child(4)").text
            var th05 = $(this).parent("td:nth-child(5)").text
            var th06 = $(this).parent("td:nth-child(6)").text
            var row02={
                "teamid":th01,
                "email":th02,
                "password":th03,
                "newsletter":th04,
                "phoneno":th05,
                "username" :th06,
                "membername":th07,
                "address" :th08,
            }
            $.ajax({
            type: "POST",
            dataType: "json",
            url: "/edit/Member/",
            data: row02,
        })
        
    })

}
    loadTodo()
})
</script>
{% endblock %}